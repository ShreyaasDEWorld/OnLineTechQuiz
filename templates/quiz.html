<!-- TIMER -->
<div style="font-size:18px; color:red; margin-bottom:20px;">
    Time Left: <span id="timer"></span>
</div>

<form method="POST">
    {% for q in questions %}
        <div class="question">
            <p><strong>Q{{ loop.index }}. {{ q[1] }}</strong></p>

            {% for i in range(1,5) %}
                <div class="option">
                    <input type="radio"
                           name="question_{{ q[0] }}"
                           value="{{ i }}"
                           required>
                    {{ q[i+1] }}
                </div>
            {% endfor %}
        </div>
    {% endfor %}

    <div style="margin-top:20px;">
        {% if page > 1 %}
            <a href="/quiz?page={{ page-1 }}">⬅ Previous</a>
        {% endif %}

        {% if page < total_pages %}
            <button type="submit">Next ➡</button>
        {% else %}
            <button type="submit">Submit Quiz</button>
        {% endif %}
    </div>
</form>

<!-- TIMER SCRIPT -->
<script>
    let timeLeft = {{ quiz_time }};

    function startTimer() {
        let timer = setInterval(function () {
            let minutes = Math.floor(timeLeft / 60);
            let seconds = timeLeft % 60;

            document.getElementById("timer").innerHTML =
                minutes + ":" + (seconds < 10 ? "0" : "") + seconds;

            if (timeLeft <= 0) {
                clearInterval(timer);
                alert("Time is up! Submitting quiz.");
                document.querySelector("form").submit();
            }

            timeLeft--;
        }, 1000);
    }

    window.onload = startTimer;
</script>
